<!DOCTYPE html>
<html lang="en" ng-app="forgotApp">
<head>
  <meta charset="UTF-8">
  <title>Forgot Password – Budgetwala</title>

  <link rel="stylesheet" href="/frontend/Home/styles.css">
  <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>

  <style>
    body {
      overflow-x: hidden;
    }

    .slider-container {
      width: 300%;
      display: flex;
      transition: transform 0.1s ease-in-out;
    }

    .slide {
      width: 100%;
      flex-shrink: 0;
    }

    .wrapper {
      width: 100%;
      overflow: hidden;
    }
  </style>
</head>

<body ng-controller="ForgotController">

<section class="auth wrapper">
  <div class="slider-container"
       ng-style="{'transform':'translateX(-' + step * 100 + '%)'}">

    <!-- ================= STEP 1 : FORGOT PASSWORD ================= -->
    <div class="slide">
      <div class="auth-box">
        <h2>Forgot Password</h2>
        <p>Enter your Information to receive OTP</p>

        <form ng-submit="sendOtp()">
          <input type="email"
                 placeholder="Registered Email"
                 ng-model="user.email"
                 required>

          <input type="text"
                 placeholder="Telegram Chat ID"
                 ng-model="user.telegram_chat_id"
                 required>

          <button class="btn" style="width:100%">
            Send OTP via Telegram
          </button>
        </form>

        <p style="color:green" ng-if="message">{{ message }}</p>
        <p style="color:red" ng-if="error">{{ error }}</p>
      </div>
    </div>

    <!-- ================= STEP 2 : VERIFY OTP ================= -->
    <div class="slide">
      <div class="auth-box">
        <h2>Verify OTP</h2>
        <p>Enter the OTP sent to your Telegram</p>

        <form ng-submit="verifyOtp()">
          <input type="text"
                 placeholder="Enter OTP"
                 ng-model="otp"
                 required>

          <button class="btn" style="width:100%">
            Verify OTP
          </button>
        </form>

        <p style="color:green" ng-if="message">{{ message }}</p>
        <p style="color:red" ng-if="error">{{ error }}</p>
      </div>
    </div>

    <!-- ================= STEP 3 : RESET PASSWORD ================= -->
    <div class="slide">
      <div class="auth-box">
        <h2>Reset Password</h2>

        <form ng-submit="resetPassword()">
          <input type="password"
                 placeholder="New Password"
                 ng-model="password"
                 required>

          <input type="password"
                 placeholder="Confirm Password"
                 ng-model="confirm"
                 required>

          <p ng-if="password !== confirm"
             style="color:red;font-size:12px;">
            Passwords do not match
          </p>

          <button class="btn"
                  style="width:100%"
                  ng-disabled="password !== confirm">
            Reset Password
          </button>
        </form>

        <p style="color:green" ng-if="message">{{ message }}</p>
        <p style="color:red" ng-if="error">{{ error }}</p>
      </div>
    </div>

  </div>
</section>

<script>
  var app = angular.module("forgotApp", []);

  app.controller("ForgotController", function ($scope, $timeout) {

    $scope.step = 0;   // 0 → forgot, 1 → otp, 2 → reset
    $scope.user = {};

    /* STEP 1 */
    $scope.sendOtp = function () {
      // API call here
      $scope.message = "OTP sent successfully";
      $scope.error = "";

      $timeout(function () {
        $scope.step = 1;
        $scope.message = "";
      }, 800);
    };

    /* STEP 2 */
    $scope.verifyOtp = function () {
      // API call here
      if ($scope.otp === "123456") { // example
        $scope.message = "OTP verified";
        $scope.error = "";

        $timeout(function () {
          $scope.step = 2;
          $scope.message = "";
        }, 800);
      } else {
        $scope.error = "Invalid OTP";
      }
    };

    /* STEP 3 */
    $scope.resetPassword = function () {
      // API call here
      $scope.message = "Password reset successful";
      $scope.error = "";
    };

  });
</script>

</body>
</html>
